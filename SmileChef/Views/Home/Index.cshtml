@{
    ViewData["Title"] = "Home Page";
}

<style>
    .box {
        width: 100%;
        height: auto;
    }
</style>


<div class="container-md">
    @Html.ActionLink("RecipeSmartAI", "RecipeSmartAI", "Home", new { }, new { @class = "btn btn-info my-4" })

    <div class="row">
        <div class="col-auto">
            <button id="loadAnimals" class="btn btn-primary">Load Animals</button>
        </div>
        <div class="col-auto">
            <button id="loadHumans" class="btn btn-primary">Load Humans</button>
        </div>
        <div class="col-auto">
            <button id="loadAliens" class="btn btn-primary">Load Aliens</button>
        </div>
        <div class="col-auto">
            <button id="clearAll" class="btn btn-primary">Clear All</button>
        </div>
    </div>
    <div class="row mt-3 mx-auto gap-5">
        <div class="col-md-3 border border-black">
            <h2 class="border-bottom border-2 border-black">Animals</h2>
            <div id="animalsContainer" class="box"></div>
        </div>
        <div class="col-md-3 border border-black">
            <h2 class="border-bottom border-2 border-black">Humans</h2>
            <div id="humansContainer" class="box"></div>
        </div>
        <div class="col-md-3 border border-black">
            <h2 class="border-bottom border-2 border-black">Aliens</h2>
            <div id="aliensContainer" class="box"></div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            /* 
            Swal.fire({
                title: "Test 01",
                text: "Javascript is laoded and swal working",
                icon: "success"
            });
            */

            function createListItem(text, index) {
                let idxString = index == null ? "" : `${index}. `
                return $(`<li class="list-group-item col-12 border border-black rounded-2">${idxString}${text}</li>`);
            }


            function handleLoad(urlPassed, containerId) {
                $.ajax({
                    url: urlPassed,
                    type: "GET",
                    success: function (response) {
                        console.log("Response sent from server:");
                        console.log(response);
                        let ulElem = $('<ul class="list-group py-2 gap-2 row px-2"></ul>');

                        response.forEach((aItem, idx) => {
                            let liElem = createListItem(aItem, idx + 1);
                            $(ulElem).append(liElem);
                        })
                        $(containerId).html(ulElem);
                    },
                    error: function (xhr, status, error) {
                        var errorMessage = xhr.status + ': ' + xhr.statusText;
                        console.log('Error - ' + errorMessage);
                        Swal.fire({
                            title: "Error Occurred",
                            text: errorMessage,
                            icon: "error"
                        });
                    }
                });
            }

            $('#loadAnimals').on('click', function () {
                handleLoad('@Url.Action("LoadAnimals", "Home")', '#animalsContainer');
            });

            $('#loadHumans').on('click', function () {
                handleLoad('@Url.Action("LoadHumans", "Home")', '#humansContainer');
            });

            $('#loadAliens').on('click', function () {
                handleLoad('@Url.Action("LoadAliens", "Home")', '#aliensContainer');
            });

            $('#clearAll').click(() => {
                $('#animalsContainer').empty();
                $('#humansContainer').empty();
                $('#aliensContainer').empty();

                console.error("Error: All the containers have been emptied");
            });
        });
    </script>
}